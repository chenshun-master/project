<!DOCTYPE html>
<html lang="en">
<head>
    <!--  <meta content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" name="viewport" />-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=750px, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="telephone=no" name="format-detection" />
    <link rel="stylesheet" type="text/css" href="/static/css/index.css" />
    <title>主页</title>
    <style>
        .wkf{
            display: none;
            position: fixed;
            top: 565px;
            left: 256px;
            width: 240px;
            height: 56px;
            line-height: 56px;
            text-align: center;
            background: #0FD6DD;
            color: #FFFFFF;
            font-size:0.28rem;
            border-radius:10px ;
        }
    </style>
    <script src="/static/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/static/js/rem.js" type="text/javascript" charset="utf-8"></script>
</head>
<body style="background: #ffffff;">
<div class="con" >
    <div class="wx-top">
        <a href="" class="topa"></a>
    </div>
    <ul class="biao">
        <li style="margin-left: 34px;"><a href="">推荐</a></li>
        <li><a href="">文章</a></li>
        <li><a href="">视频</a></li>
        <li><a href="">案例</a></li>
        <li><a href="">问答</a></li>
        <li style="margin-right: 36px;"><a href="">其它</a></li>
    </ul>
    <div id="cus-container"></div>
    <div  onclick="objClass.loadList()" style="font-size: 34px;text-align: center;height: 50px;line-height: 50px;"> 加载更多</div>
</div>
</body>
<script src="/static/js/functions.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    var objClass = {
        listData:{
            loading:false,
            ini:false,
            page:0,
            page_total:1,
            page_size:10,
        },

        //相关推荐数据加载
        loadList:function(){
            if(this.listData.loading){
                return false;
            }

            this.listData.page++;
            if(this.listData.ini == true){
                if(this.listData.page > this.listData.page_total){
                    redream.showTip('已加载所有数据');
                    return false;
                }
            }
            $.ajax({
                url:"/weixin/index/getArticleList",
                type:'post',
                data:{type:0,page:this.listData.page,page_size:this.listData.page_size},
                dataType:'json',
                beforeSend:function(){
                    objClass.listData.loading = true;
                },
                complete:function(){
                    objClass.listData.loading = false;
                },
                success:function(res){
                    if(res.code == 200){
                        if(objClass.listData.ini == false){
                            objClass.listData.ini = true;
                            objClass.listData.page_total = res.data.page_total;
                        }
                        $('#cus-container').append(res.data.conetnt);
                    }
                }
            });
        },

    };

    setTimeout(function(){
        objClass.loadList();
    },500);

    $(document).on('click','.cus-article-href',function(){
        if($(this).data('type') == 1){
            window.location.href = '/weixin/article/articleDetails/id/'+ $(this).data('id');
        }
    });
</script>

</html>
