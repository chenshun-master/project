<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>登录页</title>
		<link rel="stylesheet" href="/pc/css/login.css">

		<link rel="stylesheet" href="/static/css/iconfont.css">

	</head>
	<body >
	<div  id="wl-con">
        <!--登录页-->
		<div id="wl-neirong" >
			<div class="wl-left">
                <img src="/pc/image/zhulogo.png" alt="" style="margin-top: 55px">
				<dl>还没有账号？</dl>
				<dd>立即免费注册！</dd>
				<dt>现在注册，遇见不一样的自己</dt>
				<button class="wl-zc" onclick="zhuce()">注册</button>
			</div>
			<div class="wl-right">
               <span class="wl-tub">登录</span>
				<!--<div class="wl-ma"></div>-->
				<!--<div class="wl-ma-dun"><span style="  margin-top: -10px"> <img src="/pc/image/bg-dun.png" alt="" width="35px" height="35px" style="margin-top: 4px;margin-left: 8px"><span class="wl-sao-zi">扫码登录更安全</span></span></div>-->
			<div class="wl-shuru">
               <p><input type="text" placeholder="请输入你的手机号" class="wl-input"><i class="iconfont icon-my_light" style="font-size: 30px;color: #A9A9A9"></i></p>
                <p ><input type="text" placeholder="请输入密码" class="wl-input"><i class="iconfont icon-yanjing" style="font-size: 30px;color: #A9A9A9"></i></p>
                <button href="" style="color: #A9A9A9;font-size: 16px;margin-top: 30px;background: white;margin-left: 44px" onclick="zhuce2()">忘记密码？</button>
                <button class="btn">登录</button>
            </div>
            </div>
		</div>
        <!--修改密码页面-->
        <div  id="wl-neirong1" style="display: none">
            <div class="wl-left">
                <img src="/pc/image/zhulogo.png" alt="" style="margin-top: 55px">
                <dl>还没有账号？</dl>
                <dd>立即免费注册！</dd>
                <dt>现在注册，遇见不一样的自己</dt>
                <button href="" class="wl-zc1" onclick="zhuce()">注册</button>
            </div>
            <div class="wl-right">
                <span class="wl-tub1">重置密码</span>
                <div class="wl-shuru1">
                    <p style="margin-top: 40px"><input type="text" placeholder="请输入你的手机号" class="wl-input" style="width: 290px"><a href="" style="color: #7DB0E8;font-size: 14px;float: right;margin-top: 13px">获取验证码</a></p>
                    <p ><input type="text" placeholder="请输入你收到的验证码" class="wl-input"></p>
                    <p ><input type="text" placeholder="请输入密码" class="wl-input"><i class="iconfont icon-yanjing" style="font-size: 30px;color: #A9A9A9"></i></p>
                    <button>完成</button>
                </div>
            </div>
        </div>
        <!--注册页-->
        <div id="wl-neirong2" style="display: none" >
            <div class="wl-left1">
                <img src="/pc/image/zhulogo.png" alt="" style="margin-top: 55px">
                <dl>已有账号？</dl>
                <dd>立即登录！</dd>
                <dt>现在登录，遇见不一样的自己</dt>
                <button class="wl-zc1" onclick="zhuce1()">登录  </button>
            </div>
            <div class="wl-right1">
                <p style=" height: 70px;line-height: 70px;border-bottom: 1px solid #A5A5A5; "><i class="iconfont icon-shouji" style="font-size: 40px;margin-left: 50px"></i><span style="    color: #262626;font-size: 14px;float: right;margin-right: 337px;">用手机注册</span></p>
                <span class="wl-tub2">注册</span>
                <div class="wl-shuru1" style="margin-top: 10px">
                    <p ><input type="text" placeholder="请输入你的手机号" class="wl-input" style="width: 300px"><a href="" style="color: #7DB0E8;font-size: 14px;float: right;margin-top: 13px">获取验证码</a></p>
                    <p ><input type="text" placeholder="请输入你收到的验证码" class="wl-input"></p>
                    <p ><input type="text" placeholder="6~16个字符，区分大小写" class="wl-input" style="width: 320px"><i class="iconfont icon-yanjing" style="font-size: 30px;color: #A9A9A9"></i></p>
                    <button>立即注册</button>
                </div>
            </div>
        </div>
	</div>
	</body>
	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script src="/pc/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.min.js"></script>
    <script>
        function zhuce(){
            $('#wl-neirong2').show();
            $('#wl-neirong').hide();
            $('#wl-neirong1').hide();
        }
        function zhuce1(){
            $('#wl-neirong').show();
            $('#wl-neirong1').hide();
            $('#wl-neirong2').hide();
        }
        function zhuce2(){
            $('#wl-neirong1').show();
            $('#wl-neirong').hide();
            $('#wl-neirong2').hide();
        }

        var codeObj = new VerificationCode('code-btn','获取验证码','code-hui');
        codeObj.run();

        var  objClass = {
            oneLoading:false,
            twoLoading:false,
            sendSmsCode:false,
            checkMobile:function(mobile){
                var reg_phone = /^[1][3,4,5,7,8][0-9]{9}$/;
                return reg_phone.test(mobile);
            },
            submitOne:function(){
                var mobile = $('#mobile1').val();
                var sms_code = $('#sms_code').val();

                if(!this.checkMobile(mobile)){
                    layer.open({content: '手机号格式不正确！',skin: 'msg',time: 2});
                    return false;
                }

                if(sms_code == ''){
                    layer.open({content: '请填写验证码！',skin: 'msg',time: 2});
                    return false;
                }

                if(!this.oneLoading){
                    $.ajax({
                        url:"/weixin/index/codeLogin",
                        type:'post',
                        data:{mobile:mobile,sms_code:sms_code},
                        dataType:'json',
                        beforeSend:function(){
                            objClass.oneLoading = true;
                        },
                        complete:function(){
                            objClass.oneLoading = false;
                        },
                        success:function(res){
                            if(res.code == 200){
                                layer.open({type: 2,content: '登录中...',time:4});
                                setTimeout(function(){
                                    window.location.href = '/weixin/user/main';
                                },2000);
                                return false;
                            }else if(res.code == 301){
                                layer.open({content: '请求参数错误',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 302){
                                layer.open({content: '验证码错误',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 303){
                                layer.open({content: '验证码已过期',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 304){
                                layer.open({content: '用户不存在',skin: 'msg',time: 2});
                                return false;
                            }else {
                                layer.open({content: '登录失败',skin: 'msg',time: 2});
                                return false;
                            }
                        }
                    });
                }
            },
            submitTwo:function(){
                var mobile = $('#mobile2').val();
                var password = $('#password').val();
                if(!this.checkMobile(mobile)){
                    layer.open({content: '手机号格式不正确！',skin: 'msg',time: 2});
                    return false;
                }
                if(!objClass.twoLoading){
                    $.ajax({
                        url:"/weixin/index/postLogin",
                        type:'post',
                        data:{mobile:mobile,password:password},
                        dataType:'json',
                        beforeSend:function(){
                            objClass.twoLoading = true;
                        },
                        complete:function(){
                            objClass.twoLoading = false;
                        },
                        success:function(res){
                            if(res.code == 200){
                                layer.open({type: 2,content: '登录中...',time:4});
                                setTimeout(function(){
                                    window.location.href = '/weixin/user/main';
                                },2000)
                                return false;
                            }else if(res.code == 301){
                                layer.open({content: '请求参数错误',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 302){
                                layer.open({content: '用户不存在',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 303){
                                layer.open({content: '用户密码填写错误',skin: 'msg',time: 2});
                                return false;
                            }else{
                                layer.open({content: '登录失败',skin: 'msg',time: 2});
                                return false;
                            }
                        }
                    });
                }
            },
            sendSms:function(){
                var mobile = $('#mobile1').val();
                if(!this.checkMobile(mobile)){
                    layer.open({content: '手机号格式不正确！',skin: 'msg',time: 2});
                    return false;
                }

                if(codeObj.checkTime()){
                    return false;
                }

                if(!this.sendSmsCode){
                    $.ajax({
                        url:"/weixin/index/sendQuickLoginSmsCode",
                        type:'post',
                        data:{mobile:mobile},
                        dataType:'json',
                        beforeSend:function(){
                            objClass.sendSmsCode = true;
                        },
                        complete:function(){
                            objClass.sendSmsCode = false;
                        },
                        success:function(res){
                            if(res.code == 200){
                                layer.open({content: '发送成功',skin: 'msg',time: 2});
                                codeObj.sendSmsCode();
                                return false;
                            }else if(res.code == 301){
                                layer.open({content: '请求参数错误',skin: 'msg',time: 2});
                                return false;
                            }else if(res.code == 302){
                                layer.open({content: '该手机号未注册',skin: 'msg',time: 2});
                                return false;
                            }
                        }
                    });
                }
            }
        };
    </script>
</html>
