<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>发表文章</title>
    <link rel="stylesheet" href="/static/web/css/test.css">
    <link rel="stylesheet" href="/static/web/css/relrase.css">
    <link rel="stylesheet" href="/static/css/iconfont.css">
    <link rel="stylesheet" href="/static/web/css/graphic.css">
    <link rel="stylesheet" href="/static/css/function.css">
    <link rel="stylesheet" href="/static/plugin/layui/css/layui.css">
</head>
<body style="background: #F8F8F8">
<div class="wl-con">
    <div class="wl-top">
        <div style="position:relative;width:1265px;margin:0 auto;top:20px;left: 10px">
            <img src="/static/web/image/logo1.png" alt="">
        </div>
    </div>
    <div class="wl-zhanghao-box"
         style="position:relative;width:1265px;margin:0 auto;top:-80px;right: 42px;cursor: pointer">
        <div class="wl-zhanghao" style="right:0;">
            <p style="height: 80px;padding-top: 9px; background: #7DB0E8;" class="wl-xian">
                <img src="" class="wl-toux" onerror="this.src='/static/web/image/tou.png'"/>
                <span style="color: white;margin-left: 48px;float: left;margin-top: -1px;">吴永辉</span><i
                    class="iconfont icon-triangledownfill" style="color: white;"></i></p>
            <div class="wl-cang" style="display: none">
                <a href="/index/user/main"><p class="wl-xiany" id="wl-anquan"><i class="iconfont icon-shezhi" style="font-size: 22px;margin-right: 10px"></i>账号设置
                </p></a>
                <p class="wl-xiany" onclick="redream.href('/index/user/signOut')"><i class="iconfont icon-guanbi" style="font-size: 18px;margin-right: 10px"></i>退出登录</a>
                </p>
            </div>
        </div>
    </div>
    <div class="wl-tabc" style="width: 100%">
        <div class="tab-box" style="position: relative">
            <div class="wl-nide">
                <ul class="wl-top-liebiao">
                    <a href="/index/article/article">
                        <li class=""><i class="iconfont icon-quanbu2 wl-biao" style="font-size: 25px;"></i>文章列表<i
                                class="iconfont icon-triangledownfill wl-xiala " style="font-size: 20px;top: 0;"></i>
                        </li>
                    </a>
                    <div class="wl-ding">
                        <!-- <li >发表文章</li> </a>-->
                        <!--<a href="/index/article/graphic"> <li >我的文章 </li></a>-->
                    </div>
                </ul>
                <ul class="wl-top-liebiao" style="margin-top: 10px">
                    <li class="wl-yingj"><i class="iconfont icon-quanbu2 wl-biao" style="font-size: 25px;"></i>分销商品
                        <i  class="iconfont icon-triangleupfill wl-xiala qiehuan" style="font-size: 20px;top: 0;"></i>
                    </li>
                    <div class="wl-ding">
                        <a href="/index/shop/index">
                            <li class="action">商品列表</li>
                        </a>
                        <a href="/index/shop/myshoplist">
                            <li>分销列表</li>
                        </a>
                    </div>
                </ul>
                <a href="/index/user/certification">
                    <div class="wl-shiming">
                        <i class="iconfont icon-medal_light wl-biao" style="font-size: 25px;"></i>实名认证
                        <i  class="iconfont icon-triangledownfill wl-xiala" style="font-size: 20px;top: 0;"></i>
                    </div>
                </a>
            </div>
            <div class="wl-fabu padding">
                <p style="border: 0">全部项目</p>
                <div class="wl-xianshi-neirong">
                    <div class="wl-list" id="category-container">
                        <div class="wl-project category-hierarchy" data-hierarchy="1" >
                            <div>项目</div>
                            <div class="wl-liebiao">
                                <span class="se myselecte">全部</span>
                                {foreach($categoryList as $k=>$val)}
                                    <span data-findid="1"  data-pid="{$val['id']}"  data-id="{$val['id']}" class="click-find-category">{$val['name']}</span>
                                {/foreach}
                            </div>
                            <div style="clear: both"></div>
                        </div>
                    </div>
                    <div style="clear: both"></div>
                    <div>
                        <div style="width: 50px;height: 30px;background: #7DB0E8;line-height: 30px;text-align: center;margin-top: 5px;color: white;cursor: pointer;border-radius: 3px;">查询</div>
                    </div>

                    <div>
                        <ul class="wl-sorting">
                            <li class="active">智能排序</li>
                            <li>评分最高</li>
                            <li>最新上架</li>
                            <li class="wl-price">
                                价格排序
                                <ul class="wl-sorting-gao">
                                    <li>价格最高</li>
                                    <li>价格最低</li>
                                </ul>
                            </li>
                        </ul>
                        <div style="clear: both"></div>
                    </div>

                    <div id="content">

                    </div>
                    <div style="clear: both"></div>


                    <div id="wl-fenye" ></div>

                    <footer class="wl-foot" style="bottom: -110px">{:config('conf.copyright')}</footer>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/static/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/js/functions.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/plugin/layui/layui.all.js"></script>

<script id="shoptemplateList" type="text/html">
    {{#  layui.each(d, function(index, item){ }}
        <div class="wl-shangpin-quan">
            <dl><img src="{{ item.img }}" alt=""></dl>
            <dt class="wl-shang-title">{{item.name}}</dt>
            <dt class="wl-yiyuan">{{item.hospital_name}}</dt>
            <dd class="wl-jiage"><sup style="font-size: 10px">￥</sup>{{item.sell_price}}</dd>
            <dd class="wl-fenxiao click-to-create" data-goods_id="{{ item.id }}">推荐分销</dd>
        </div>
    {{#  }); }}
</script>

<script id="categoryList" type="text/html">
    <div class="wl-project category-hierarchy" data-hierarchy="{{ d.hierarchy }}" >
        <div>{{ d.name }}</div>
        <div class="wl-liebiao">
            <span class="se myselecte " data-id="{{ d.all }}">全部</span>
            {{#  layui.each(d.rows, function(index, item){ }}
                <span data-findid="{{ d.hierarchy }}"  data-pid="{{item.id}}"  data-id="{{item.id}}" class="click-find-category">{{item.name}}</span>
            {{#  }); }}
        </div>
        <div style="clear: both"></div>
    </div>
</script>

<script>
    $(".wl-xian").click(function () {
        $(".wl-cang").toggle();
    });
    $(".wl-price").click(function () {
        $(".wl-sorting-gao").toggle();
    });

    $(".wl-sorting li").click(function () {
        $(this).addClass("active").siblings().removeClass("active");//获取选中元素的下标
    });

    $(".wl-yingj").click(function () {
        $(".wl-ding").toggle();
        $(".qiehuan").toggleClass('iconfont  icon-triangledownfill');
        $(".qiehuan").toggleClass('iconfont icon-triangleupfill');
    });

    $(document).on('click', '.click-to-create', function () {
        window.location.href = '/index/shop/shopEditor?gid='+$(this).data('goods_id');
    });

    var listObj = {
        params:{
            page: 0,
            page_size: 15,
            category:'',
            sort:0,
            city:'',
            keywords:''
        },
        loadlist:function(laypageObj){
            $.ajax({
                url: "/index/shop/getShopList",
                type: 'post',
                data: listObj.params,
                dataType: 'json',
                success: function (res) {
                    layui.laytpl(shoptemplateList.innerHTML).render(res.data.rows, function(html){
                        $('#content').html(html);
                    });
                }
            });
        }
    };


    layui.laypage.render({
        elem: 'wl-fenye'
        ,limit:15
        ,curr:1
        ,jump: function(obj, first){
            listObj.loadlist(obj);
        }
    });

    var objClass = {
        categoryList:[],
        loading:false,
        ajaxLloadingCategory:function(hierarchy,pid){

            $.ajax({
                url: '/index/shop/getCategoryList',
                type: 'POST',
                data:{category_id:pid},
                dataType: "json",
                success: function (res) {
                    if(res.code == 200){
                        var hierarchy2 = parseInt(hierarchy) + 1;
                        var name = '';
                        if(hierarchy2 == 2){
                            name = '二级';
                        }else if(hierarchy2 == 3){
                            name = '三级';
                        }else if(hierarchy2 == 4){
                            name = '四级';
                        }else if(hierarchy2 == 3){
                            name = '五级';
                        }
                        if(res.data.rows.length > 0){
                            layui.laytpl(categoryList.innerHTML).render({rows:res.data.rows,hierarchy:hierarchy2,all:pid,name:name}, function(html){
                                $('#category-container').append(html);
                            });
                        }
                    }
                },
            });
        },
    };

    $(document).on('click','.click-find-category',function(){
        $(this).addClass("se").siblings().removeClass("se");
        var index = $(this).parent().parent().index();
        var length = $('.category-hierarchy').length -1;
        for (var i=length; i >= 0; i--){
            if(i > index){
                $('.category-hierarchy').eq(i).remove();
            }
        }

        objClass.ajaxLloadingCategory($(this).data('findid'),$(this).data('pid'));
    });
</script>
</body>
</html>