<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content>
    <title>Title</title>
    <link rel="stylesheet" href="/pc/css/relrase.css">
    <link rel="stylesheet" href="/static/css/iconfont.css">
    <style>
        button {
            cursor: pointer
        }
    </style>
</head>
<body  style="background: #F8F8F8"   >
<div class="wl-con" >
    <div class="wl-top" >
        <div style="position:relative;width:1265px;margin:0 auto;top:17px;left: 10px">
            <img src="/pc/image/logo1.png" alt="" >
        </div>
    </div>
    <div class="wl-zhanghao-box" style="position:relative;width:1265px;margin:0 auto;top:-80px;right: 42px;cursor: pointer">
        <div class="wl-zhanghao" style="right:0;">
            <p style="height: 80px;padding-top: 9px; background: #7DB0E8;" class="wl-xian"><span class="wl-toux"></span><span style="color: white;margin-left: 48px;float: left;margin-top: -1px;">用户名称</span><i class="iconfont icon-triangledownfill" style="color: white;"></i> </p>
            <div class="wl-cang" style="display: none">
                <p class="wl-xiany" id="wl-anquan"><i class="iconfont icon-shezhi" style="font-size: 22px;margin-right: 10px"></i>账号设置</p>
                <p class="wl-xiany"><i class="iconfont icon-guanbi" style="font-size: 18px;margin-right: 10px"></i>退出登录</p>
            </div>
        </div>
    </div>
    <div class="tab-box" >
        <div class="wl-fabiao" style="cursor: pointer" onclick="redream.href('/index/article/test')">发表文章</div>
        <ul class="renzheng">

            <div class="wl-xian1" onclick="redream.href('/index/user/certification')">
                <span class="wl-shimin1"><i class="iconfont icon-medal_light wl-xz" style="font-size: 30px"></i>实名认证</span></i>
            </div>
            <!--<div class="wl-cang1"  >-->
                <!--<li class="active">个人认证</li>-->
                <!--<li>医生认证</li>-->
                <!--<li>医院认证</li>-->
                <!--<li>官方认证</li>-->
            <!--</div>-->
        </ul>
        <!--style="display: none"-->
        <div class="wl-qiehuan" >
            <div class="top" style="cursor: pointer">
                <span class="wl-anquan">账号信息</span>
                <span >安全中心</span>
            </div>
            <div class="xia">
                <div class="one">
                    <div class="one-1">
                        <img src="/pc/image/tou.png"  onerror="/pc/image/tou.png" >
                        <dt>{$user_info['nickname']}</dt>
                        <dd>{$user_info['profile']}</dd>
                        <button style="float: right;margin-top: 48px;cursor: pointer" class="wl-xgxx">修改信息</button>
                    </div>
                    <div style="width: 100px;height: 666px;float: left;color:#333333;font-size: 16px; ">
                        <dl style="margin-top:31px;">账号信息</dl>
                        <dl style="margin-top:138px;">登录方式</dl>
                        <dl style="margin-top:60px;">运营人信息</dl>
                    </div>
                    <div class="wl-grxx">
                        <div>
                            <span>用户类型</span>
                            <span>
                                <?php if($user_info['type'] == 1):?>
                                申请认证
                                <?php elseif($user_info['type'] == 2):?>
                                    认证会员
                                <?php elseif($user_info['type'] == 3):?>
                                    认证医生
                                <?php elseif($user_info['type'] == 4):?>
                                    认证医院
                                <?php elseif($user_info['type'] == 5):?>
                                    官方团队
                                <?php endif;?>
                            </span>
                        </div>
                        <div><span>用户账号</span>  <span>{$user_info['mobile']}</span></div>
                        <div> <span>绑定手机</span> <span>{$user_info['mobile']}</span><span style="float: right">如需更换,<i style="color: #FD7D7D">请前往"安全中心"</i></span></div>
                        <div> <span>运营人</span> <span>打个粉丝</span></div>
                        <div><span>联系邮箱</span>  <span>无</span></div>
                        <div><span>所在地</span>  <span>无</span></div>
                    </div>
                </div>
                <div class="two">
                    <div class="two-1">
                        <img src="/pc/image/wl-dunpai.png" alt="">
                    </div>
                    <div class="two-2">
                        <div><span>绑定手机</span><span style="color: #888888;margin-left: 100px" >当前已绑定</span><span style="color: #7DB0E8;margin-left: 210px;cursor: pointer" class="wl-hf">更改手机</span></div>
                        <div><span>登录密码</span><span style="color: #7DB0E8;margin-left: 391px;cursor: pointer" class="wl-xgmm">修改密码</span></div>
                    </div>
                </div>
            </div>
        </div>

        <style>
            .code-hui{
                color: #cccccc !important;
            }
            .wl-zheque{
                color: #cccccc !important;
            }
        </style>
    <div class="wl-zhez">
        <div class="wl-zl" >
            <div>手机号修改</div>
            <div class="wl-zheh"><span style="margin-left: 96px">更换号码</span><input type="text" placeholder="请输入手机号" id="mobile" onkeyup = "value=value.replace(/[^\d]/g,'')" maxlength="11"></div>
            <div class="wl-zheh" ><span>手机验证码</span><input type="text" placeholder="请输入短信验证码" id="sma_code" onkeyup = "value=value.replace(/[^\d]/g,'')"  maxlength="6"  /><button id="code-btn" onclick="objClass.sendSms()" >发送验证码</button></div>
            <div class="wl-yzmcw"><span>验证码错误</span></div>
            <!--<div class="wl-yzcg"  >验证成功</div>-->
            <div class="wl-zheque"><button  onclick="objClass.submit()">确定</button></div>
        </div>
    </div>
    <div class="wl-zhez1">
        <div class="wl-zl1" >
            <div>密码修改</div>
            <div class="wl-yibang">通过已绑定手机 <span>{$user_info['mobile']|mobileFilter}</span> 进行验证</div>
            <div class="wl-zhes"><span>输入验证码</span><input type="text" placeholder="请输入短信验证码" id="sma_code1" onkeyup = "value=value.replace(/[^\d]/g,'')"  maxlength="6"><button id="code-btn1" onclick="objClass1.sendSms1()">发送验证码</button></div>
            <div class="wl-zhes"><span>设置新密码</span><input type="password" placeholder="请输入新密码" id="password" maxlength="18"></div>
            <div class="wl-zhes"><span>确认新密码</span><input type="password" placeholder="再次输入新密码" id="password1" maxlength="18" style="z-index: 1;"></div>
            <div class="wl-zheque" style="position: absolute;bottom: -7px;"><button onclick="objClass1.submit1()">确定</button> </div>
        </div>
        <!--<div class="wl-yzcg1">-->
            <!--<div>修改个人信息</div>-->
        <!--</div>-->
    </div>
    <div class="wl-zhez2">
        <div class="wl-zl2">
            <div class="wl-gexx">修改个人信息</div>
            <div class="wl-gerenl">
                <div class="cd">
                    <img src="{$user_info['portrait']}"  onerror="/pc/image/tou.png"    width="73px" height="73px" />
                    <div class="dd">
                        更换头像
                    </div>
                </div>
                <div class="wl-ri">
                    <input type="text" placeholder="用户名称" style="text-indent: 5px;" value="{$user_info['nickname']}">
                    <p>2-10个汉字，请勿使用包含特殊符号</p>
                    <textarea name="" id="" cols="30" rows="10" style="text-indent: 5px;">{$user_info['profile']}</textarea>
                    <p>30个汉字，无特殊符号</p>
                    <button class="wl-que1">确认</button> <button  class="wl-que2">取消</button>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</body>
<script src="/static/plugin/layer_mobile/layer.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/js/verification-code.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/functions.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    //获取修改手机号验证码
    var codeObj = new VerificationCode('code-btn','获取验证码','code-hui');
    codeObj.run();
    var codeObj1 = new VerificationCode('code-btn1','获取验证码','code-hui');
    codeObj1.run();
    var objClass = {
        loading:false,
        sendSmsCode:false,
        checkMobile:function(mobile){
            var reg_phone = /^[1][3,4,5,7,8][0-9]{9}$/;
            return reg_phone.test(mobile);
        },
        submit:function () {
            var mobile = $('#mobile').val();
            var sms_code = $('#sms_code').val();
            if(!this.checkMobile(mobile)){
                layer.open({content: '手机号格式不正确！',skin: 'msg',time: 2});
                return false;
            }
            if(sms_code == '')
            {
                layer.open({content: '请填写验证码！',skin: 'msg',time: 2});
                return false;
            }
            if(!this.loading)
            {
                $.ajax({
                    url:"/index/user/modifyMobile",
                    type:'post',
                    data:{mobile:mobile,sms_code:sms_code},
                    dataType:'json',
                    beforeSend:function(){
                        objClass.loading = true;
                    },
                    complete:function(){
                        objClass.loading = false;
                    },
                    success:function(res){
                        if(res.code == 200){
                            layer.open({content: '修改成功',skin: 'msg',time: 2});
                            setTimeout(function(){
                                window.location.href = '/index/user/main';
                            },3000);
                        }else if(res.code == 301){
                            layer.open({content: '请求参数错误',skin: 'msg',time: 2});
                            return false;
                        }else if(res.code == 302){
                            layer.open({content: '验证码错误',skin: 'msg',time: 2});
                            return false;
                        }else if(res.code == 303){
                            layer.open({content: '验证码已过期',skin: 'msg',time: 2});
                            return false;
                        }else {
                            layer.open({content: '修改失败',skin: 'msg',time: 2});
                            return false;
                        }
                    }
                })
            }
        },
        sendSms:function () {
            var mobile = $('#mobile').val();
            if(!this.checkMobile(mobile)){
                layer.open({content: '手机号格式不正确！',skin: 'msg',time: 2});
                return false;
            }

            if(codeObj.checkTime()){
                return false;
            }

            if(!this.sendSmsCode){
                $.ajax({
                    url:"/index/index/sendSmsCode",
                    type:'post',
                    data:{mobile:mobile,type:6},
                    dataType:'json',
                    beforeSend:function(){
                        objClass.sendSmsCode = true;
                    },
                    complete:function(){
                        objClass.sendSmsCode = false;
                    },
                    success:function(res){
                        if(res.code == 200){
                            layer.open({content: '发送成功',skin: 'msg',time: 2});
                            codeObj.sendSmsCode();
                            return false;
                        }else if(res.code == 301){
                            layer.open({content: '请求参数错误',skin: 'msg',time: 2});
                            return false;
                        }else if(res.code == 302){
                            layer.open({content: '该用户已被使用',skin: 'msg',time: 2});
                            return false;
                        }else{
                            layer.open({content: '发送失败',skin: 'msg',time: 2});
                            return false;
                        }
                    }
                });
            }
        }
    }

    var objClass1 = {
        submit1:function () {
            var password = $('#password').val();
            var password1 = $('#password1').val();
            if(password == '')
            {
                layer.open({content: '请输入新密码！',skin: 'msg',time: 2});
                return false;
            }
            if(password1 == '')
            {
                layer.open({content: '请输入确认新密码！',skin: 'msg',time: 2});
                return false;
            }
            if(password != password1)
            {
                layer.open({content: '两次输入的密码不一致！',skin: 'msg',time: 2});
                return false;
            }

        }
    }

    $(".tab-box li").each(function(index) {
        $(this).click(function() {
            $("li.active").removeClass("active"); //注意这里
            $(this).addClass("active");
            $(".tab-content div.active-txt").removeClass("active-txt");
            $(".tab-content div").eq(index).addClass("active-txt");
        });
    });

    $('.nav-item>a').on('click',function(){
        if (!$('.nav').hasClass('nav-mini')) {
            if ($(this).next().css('display') == "none") {

                $('.nav-item').children('ul').slideUp(300);
                $(this).next('ul').slideDown(300);
                $(this).parent('li').addClass('nav-show').siblings('li').removeClass('nav-show');
            }else{

                $(this).next('ul').slideUp(300);
                $('.nav-item.nav-show').removeClass('nav-show');
            }
        }
    });

    $(".wl-xian").click(function () {
        $(".wl-cang").toggle();
    })
    $(".wl-xian1").click(function () {
        $(".wl-cang1").toggle();
    })

</script>
<script type="text/javascript">
    $(function(){
        $(".one").show();
        $(".top span").eq(0).addClass("se");
        var a;
        var b;
        var index=0;
        $(".top span").click(function(){
            index=$(this).index();
            $(".one,.two").eq(index).show().siblings().hide();
            $(".top span").eq(index).addClass("se").siblings().removeClass("se");
            if(index==0){
                a=1
            }
            if(index==1){
                b=1
            }
            if(a==1&&b==1){
                $("#xiao").hide();
            }
        })
    })

    $("#wl-anquan").click(function () {
        $(".wl-qiehuan").show();
        $(".tab-content").hide();
    })
    $(".renzheng").click(function () {
        $(".tab-content").show();
        $(".wl-qiehuan").hide();
    })
    $(".wl-que2").click(function () {
        $(".wl-zhez2").hide();
    })
    // 更换手机遮罩层
    $(document).ready(function() {
        $(".wl-hf").click(function(event) {
            event.stopPropagation(); //停止事件冒泡
            $(".wl-zhez").toggle();
        });
        //点击空白处隐藏弹出层
        $(".wl-zhez").click(function(event) {
            var _con = $('.wl-zl'); // 设置目标区域
            if(!_con.is(event.target) && _con.has(event.target).length == 0) {
                $('.wl-zhez').hide(); //淡出消失
            }
        });

    });
    // 修改密码遮罩层
    $(document).ready(function() {
        $(".wl-xgmm").click(function(event) {
            event.stopPropagation(); //停止事件冒泡
            $(".wl-zhez1").toggle();
        });
        //点击空白处隐藏弹出层
        $(".wl-zhez1").click(function(event) {
            var _con = $('.wl-zl1'); // 设置目标区域
            if(!_con.is(event.target) && _con.has(event.target).length == 0) {
                $('.wl-zhez1').hide(); //淡出消失
            }
        });

    });
    // 修改信息遮罩层
    $(document).ready(function() {
        $(".wl-xgxx").click(function(event) {
            event.stopPropagation(); //停止事件冒泡
            $(".wl-zhez2").toggle();
        });
        //点击空白处隐藏弹出层
        $(".wl-zhez2").click(function(event) {
            var _con = $('.wl-zl2'); // 设置目标区域
            if(!_con.is(event.target) && _con.has(event.target).length == 0) {
                $('.wl-zhez2').hide(); //淡出消失
            }
        });

    });
</script>
</html>